deploy-to-test:
  stage: deploy
  script:
    - echo -e "\e[32mDeploying to TEST Environment\e[0m"
  rules:
    - if: '$CI_COMMIT_REF_NAME == "test" || ($CI_PIPELINE_SOURCE == "web" && $CI_COMMIT_TAG =~ /^prod-/)'
      when: always
    - when: never
  only:
    - test

#  rules:
#    - if: '$CI_COMMIT_REF_NAME == "test"'
#      when: always
#    - when: never

deploy-to-production:
  stage: deploy
  script:
    - echo -e "\e[1;31mDeploying to production Environment\e[0m"
  rules:
    #- if: '$CI_COMMIT_TAG =~ /^main-\d{8}$/'
    - if: '$CI_COMMIT_REF_NAME == "main"'
      when: manual
    - when: never
